/**
 * @name DomCom framework, 2017,
 * @author Oleksii Shnyra, UABRO
 * @website https://uabro.com
*/

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,d,k){e!=Array.prototype&&e!=Object.prototype&&(e[d]=k.value)};$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(e){return $jscomp.SYMBOL_PREFIX+(e||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(e){var d=0;return $jscomp.iteratorPrototype(function(){return d<e.length?{done:!1,value:e[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(e){$jscomp.initSymbolIterator();e={next:e};e[$jscomp.global.Symbol.iterator]=function(){return this};return e};$jscomp.makeIterator=function(e){$jscomp.initSymbolIterator();var d=e[Symbol.iterator];return d?d.call(e):$jscomp.arrayIterator(e)};$jscomp.arrayFromIterator=function(e){for(var d,k=[];!(d=e.next()).done;)k.push(d.value);return k};$jscomp.arrayFromIterable=function(e){return e instanceof Array?e:$jscomp.arrayFromIterator($jscomp.makeIterator(e))};
(function(){function e(a){var b=1;"-"===a[0]&&(b=-1,a=a.substr(1));return function(c,f){return(c[a]<f[a]?-1:c[a]>f[a]?1:0)*b}}if(window.Worker){var d=function(){return function(a,b){a=void 0===a?"div":a;if("function"===typeof a){if(!b){var c=document.createElement("div");return g.apply(c,a(c))}a=a()}"object"!==typeof a||b||(b=a,a="div");c=document.createElement(a);return b?g.apply(c,b):c}}();d.Emitter=function(){var a={};this.on=function(b,c){a[b]||(a[b]=[]);a[b].push(c)};this.emit=function(b,c){a[b]&&
a[b].forEach(function(a){return a(c)})}};var k=d.gmtr=new d.Emitter,p={},r=function(a,b){b=void 0===b?[]:b;a.childNodes.forEach(function(a){b.push(a);b.push.apply(b,[].concat($jscomp.arrayFromIterable(r(a).map(function(a){return a}))))});return b},l=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])};Object.assign(Element.prototype,{show:function(a){arguments.length||(a="");this.style.display=a;return this},hide:function(){this.show("none");return this},attr:function(a){var b=this;if("string"==
typeof a)return this.getAttribute(a);l(a,function(a,f){return b.setAttribute(a,f)});return this},crec:function(){return this.getBoundingClientRect()},clear:function(){this.h="";return this},css:function(a){var b=this;if("string"==typeof a)return this.style[a];l(a,function(a,f){"string"!=typeof f&&(f+="px");b.style[a]=f});return this},into:function(a){a.appendChild(this);return this},prepend:function(a){a.insertBefore(this,a.firstChild);return this},before:function(a){a.parentNode.insertBefore(this,
a);return this},after:function(a){a.parentNode.insertBefore(this,a.nextSibling);return this},instead:function(a){this.before(a);a.remove();return this},addClass:function(a){this.classList.add(a);return this},removeClass:function(a){this.classList.remove(a);return this},toggleClass:function(a){this.classList.toggle(a);return this},parse:function(a,b){b=void 0===b?{}:b;this.h=a.replace(/{\w*}/gi,function(a){return"\x3c!--"+a+"--\x3e"});r(this).filter(function(a){return a.nodeType===Element.COMMENT_NODE}).forEach(function(a){var c=
a.textContent.substr(1,a.textContent.length-2);b[c]&&b[c].instead(a)});return this},list:function(a){var b=this;this.clear();a.forEach(function(a){return a.into(b)});return this},extend:function(a){Object.assign(this,a);return this},on:function(){this.addEventListener.apply(this,arguments);return this},events:function(a){var b=this;l(a,function(a,f){return b.on(a,f)});return this}});l({t:{get:function(){return this.textContent},set:function(a){this.textContent!==a&&(this.textContent=a)}},h:{get:function(){return this.innerHTML},
set:function(a){this.innerHTML!==a&&(this.innerHTML=a)}},v:{get:function(){return this.value},set:function(a){this.value!==a&&(this.value=a)}},ph:{get:function(){return this.placeholder},set:function(a){this.placeholder!==a&&(this.placeholder=a)}},c:{get:function(){return this.classList},set:function(a){this.classList!==a&&(this.classList=a)}},accommodate:{set:function(a){this.clear().appendChild(a)}}},function(a,b){return Object.defineProperty(Element.prototype,a,b)});Object.defineProperty(Array.prototype,
"sortBy",{enumerable:!1,writable:!0,value:function(){return this.sort(e.apply(null,arguments))}});var g=function(a,b){g.init();a=a.toLowerCase();g.tags[a]||(g.tags[a]=[]);g.tags[a].push(b)};g.apply=function(a,b){b=void 0===b?{}:b;"function"===typeof b&&(b=b(a));var c=b.prevented?b.prevented.map(function(a){return a}):null;b.events&&l(b.events,function(f,d){if("keypress"!==f||!b.events.enter){if(c){var e=c.indexOf(f);if(~e){var h=d;d=function(b){b.preventDefault();return h.apply(a,arguments)};c.splice(e,
1)}}if("enter"===f)return a.addEventListener("keypress",function(c){if(13===c.keyCode&&!c.shiftKey)return d.bind(a)(c);b.events.keypress&&b.events.keypress(c)});a.addEventListener(f,d)}});b.attr&&a.attr(b.attr);b.c&&(a.c=b.c);b.style&&(a.style=b.style);b.extend&&a.extend(b.extend);"t"in b&&(a.t=b.t);"v"in b&&(a.v=b.v);"h"in b&&(a.h=b.h);"ph"in b&&(a.ph=b.ph);b.gmtr&&l(b.gmtr,function(a,b){return k.on(a,b)});c&&c.forEach(function(b){return a.addEventListener(b,function(a){return a.preventDefault()})});
b.init&&b.init.bind(a)();return a};g.forTag=function(a,b){var c=g.tags[b];c&&c.forEach(function(b){return g.apply(a,b)})};g.init=function(){g.initialized||(g.tags={},(new MutationObserver(function(a){return a.forEach(function(a){a.addedNodes.forEach(function(a){a.nodeType===Node.ELEMENT_NODE&&(g.forTag(a,a.nodeName.toLowerCase()),Array.prototype.forEach.call(a.attributes,function(b){return g.forTag(a,"_"+b.name)}))})})})).observe(document.body,{childList:!0,subtree:!0,attributes:!0}),g.initialized=
!0)};var q=function(a,b){this.key=a;this.listeners=[];this.liveObject=b};q.prototype.set=function(a){if(this.val!==a)return this.val=a,this.listeners.forEach(function(b){return b(a)}),this};q.prototype.def=function(a){this["default"]=a;return this};q.prototype.then=function(a){this.listeners.push(a);a(this.val||this["default"]||this.liveObject.getDef(this.key));return this};var n=function(){this.storage={};this.defaults={}};n.prototype.get=function(a,b){var c=this.storage[a]||new q(a,this);this.storage[a]||
(this.storage[a]=c);return b?c.then(b):c};n.prototype.set=function(a,b){return this.get(a).set(b)};n.prototype.def=function(a,b){this.defaults[a]=b};n.prototype.getDef=function(a){return this.defaults[a]||this["default"]};var m=function(){var a=this;this.rules=[];d.onwindow("popstate",function(b){return a.checkRules()})};m.prototype.rule=function(a,b){this.rules.push({pattern:a,fn:b})};m.prototype.checkRules=function(a){for(var b=this.rules.length-1;0<=b;--b){var c=this.rules[b];if(location.pathname.match(c.pattern)){c.fn(a);
break}}};m.prototype.go=function(a,b,c){b&&(a+="?",d.iterObj(b,function(b,c){a+=b+"="+c}));history.pushState(null,null,a);this.checkRules(c)};Object.defineProperty(m.prototype,"query",{get:function(){var a=location.search.substr(1).split("&"),b={};if(!a.length||""===a[0])return b;a.forEach(function(a){a=a.split("=");b[a[0].toLowerCase()]=a[1]});return b}});d.model=function(a,b,c){c?c.tag=b:c=b;p[a]=c};d.getModel=function(a){return p[a]};d.getModels=function(){return p};d.from=function(a,b){b=void 0===
b?{}:b;"function"===typeof b&&(b=b());var c=p[a];if(!c)return console.log("model not found. Check model name",a);var f=c(b);return f instanceof Element?f:d(c.tag||"div",f)};d.module=function(){var a=function(b,c){if(b){if(!c)return a.loaded[b];a.loaded[b]=c}else console.log("loaded module has wrong structure")};a.loaded={};a.run=function(b,c){a.loaded[b]?c.ready&&c.ready(a.loaded[b]=a.loaded[b](c.data||{})):c.err&&c.err('module "'+b+'" not loaded')};return a}();d.load=function(){var a=d.module.loaded,
b="/modules/",c=function(c){function e(){c.raw?(c.rawcss&&(d("style").into(document.head).t=c.rawcss),new Function(c.raw),d.module.run(f,c)):d("script",{attr:{src:b+f+".js"},events:{load:function(){d.module.run(f,c);this.remove()},error:function(){c.err&&c.err('module "'+f+"\" can't be loaded")}}}).into(document.head)}var f=c.name;if(a[f]&&!c.force)if(c.exist){var h=a[f];"function"==typeof c.exist&&c.exist(h)}else c.err&&c.err('module "'+f+'" already loaded. Use `force` to load it again');else c.start&&
c.start(),c.css?d("link",{attr:{rel:"stylesheet",href:b+"css/"+f+".css"},events:{load:function(){e()},error:function(a){c.err&&c.err('css for module "'+f+"\" can't be loaded")}}}).into(document.head):e()};c.config=function(a){a.src&&(b=a.src)};return c}();d.Rest=function(){function a(a,b){this._request=a;this._headers=b}function b(a,b,f){var g=this,h=this._request||new XMLHttpRequest;return new Promise(function(t,k){b||(b="");if("GET"===a&&f){b+=b.match(/\\?/)?"&":"?";var n=[];l(f,function(a,b){n.push(a+
"="+b)});b+=n.join("&")}h.open(a,c.base+b);g._headers&&d.iterObj(g._headers,function(a,b){h.setRequestHeader(a,b)});h.onreadystatechange=function(){if(4===this.readyState){try{var a=JSON.parse(this.responseText)}catch(u){a={}}this.json=a;200===this.status?t(a):k(this)}};for(var m in e)e.hasOwnProperty(m)&&h.setRequestHeader(m,e[m]);"GET"===a?h.send():(h.setRequestHeader("Content-Type","application/json"),h.send(JSON.stringify(f)))})}var c=this,e={};this.base="";var g=function(a){return function(c,
d){return b.bind(this)(a,c,d)}};this.get=a.prototype.get=g("GET");this.post=a.prototype.post=g("POST");this.put=a.prototype.put=g("PUT");this["delete"]=a.prototype["delete"]=g("DELETE");this.patch=a.prototype.patch=g("PATCH");this.setH=function(a,b){return e[a]=b};this.remH=function(a){return delete e[a]};this.headers=function(b){return new a(new XMLHttpRequest,b)};this.xhr=function(b){var c=new XMLHttpRequest;b(c);return new a(c)}};d.ready=function(a){return document.addEventListener("DOMContentLoaded",
function(){a&&a()})};d.onwindow=function(a,b){window.addEventListener(a,b)};d.branches={names:{},invoked:[],tree:{},check:function(a){var b=this.names[a];if(!b)return!1;~this.invoked.indexOf(a)||(this.names[a]=this.get(this.tree[a],b,a),this.invoked.push(a));return!0},create:function(a){if(this.names[a])return console.error("branch",a,"already registered");if(2>arguments.length)return console.error("not enough arguments to create branch");var b=arguments[arguments.length-1];if("function"!==typeof b)return console.error("no init function for branch",
a);if(2<arguments.length){if(3<arguments.length)return console.error("too much arguments for creating branch",a);this.tree[a]=arguments[1]}this.names[a]=b},get:function(a,b,c){var d=this,e=[],g;if(a)if("string"===typeof a){if(c&&a===c)return console.warn("branch",name,"invoke itself causing infinite recursion. Invocation was skipped");if(!this.check(a))return console.error("branch",a,"not exist before invocation");e.push(this.names[a])}else a.forEach(function(a){if(!g){if(c&&a===c)return console.warn("branch",
a,"invoke itself causing infinite recursion. Invocation was skipped");if(!d.check(a))return g=!0,console.error("branch",a,"not exist before invocation");e.push(d.names[a])}});return g?console.error("branch",name,"invocation failed"):b.apply(b,e)},initialize:function(a,b){var c=this;d.ready(function(){return c.get(a,b)})}};d.DomRules=g;d.Router=m;d.LiveObject=n;d.iterObj=l;d.shared={};d.fshared={};d.live=new d.LiveObject;window.gmtr=k;l({live:{get:function(){return d.live}}},function(a,b){return Object.defineProperty(window,
a,b)});window.DC=d;window.$=document.querySelector.bind(document);window.$$=document.querySelectorAll.bind(document)}else document.addEventListener("DOMContentLoaded",function(){document.body.innerHTML="<h1><b style='color:#000;padding:10px;'>You are using bad browser! What's wrong with you, man!???</b></h1>"})})();